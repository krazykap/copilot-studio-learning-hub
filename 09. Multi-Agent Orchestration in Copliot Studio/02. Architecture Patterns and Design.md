# 02. Architecture Patterns and Design

## Parent-Child Agent Architecture

### Overview
In the Parent-Child Agent Architecture, a primary "parent" agent oversees and coordinates multiple "child" agents. The parent agent is responsible for high-level decision-making, task delegation, and overall management of the child agents. Each child agent is specialized in a specific task or domain and operates under the guidance of the parent agent.

### How does it works?
- The parent agent initiates the conversation and manages the flow of the interaction.
- The child agent are invoked based on context, keywords and intent.
- The parent agent may go through multiple child agents in a single interaction.
- The data and the variables are shared between the parent agent and the child agents where required.

### Use cases and Scenarios
- HR Onboaridng: A parent agent completed general onboarding, child agent complete the onboarding of the benefits, IT establishment, and Learning & Development.
- Support Desk: PArent has incoming requests, creates delegation and child agents handle billing, technical issues, or product information requests.

### Advantages
- Centralized control and coordination, thus is easier to manage.
- User interface is simple - one entry point.
- Can group related tasks under a single parent agent.

### Limitations
- Single point of failure - if the parent agent fails, the entire system may be affected.
- Parent agent may become a bottleneck if it has to manage too many child agents.
- Logic for delegation and coordination can become complex if it has a large number of child agents.

## Connected Agents Architecture

### Overview
In the Connected Agents Architecture, multiple agents are autonomous but conneccted with each other to share information and/or coalesce on tasks. Each agent probabilistically has it's own area of expertise and can connect with other agents to provide share, and/or request information, insights, and/or assistance.

### How does it works?
- The ochestrator agent (also referred to as main entry agent) is responsible for routing and managing handsoff between agents.
- Agents can be in seperate locations and even have different teams managing it.
- Commnunication takes advantage of Copilot Studio's orchestration features and secure APIs.

### Use cases and Scenarios
- Travel Reservation: The ocherstrator is capabale of connecting seperate agents for airline reservation, hotel reservation, and car rentals (each managed by different providers).
- Financial Advisory: The ochestrator connects agents specializing in investments, retirement planning, and tax advice to provide comprehensive financial guidance.

### Advantages
- Maximum flexibility and independence for each agent.
- Agents can be developed, updated, and maintained independently.
- Easily scalable by adding new agents as needed.
- Reuse of existing agents across different workflows.

### Limitations
- Strong context passing and communication mechanisms are required to ensure seamless interaction between agents.
- Potential for increased latency due to multiple agent interactions.

## Key Considerations
<table>
	<tr>
		<th>Criteria</th>
		<th>Child Agents Pattern</th>
		<th>Connected Agent Pattern</th>
	</tr>
	<tr>
		<td>Management</td>
		<td>Centralized (single team)</td>
		<td>Decentralized (multi team)</td>
	</tr>
	<tr>
		<td>Deployment</td>
		<td>Parent Agent Only</td>
		<td>Independent for each agent</td>
	</tr>
	<tr>
		<td>Authentication</td>
		<td>Shared</td>
		<td>Seperate</td>
	</tr>
	<tr>
		<td>Reusability</td>
		<td>Limited</td>
		<td>High</td>
	</tr>
	<tr>
		<td>Governace</td>
		<td>Simple</td>
		<td>Complex</td>
	</tr>
	<tr>
		<td>Update Cycle</td>
		<td>Parent must be republished</td>
		<td>Independent agent updates</td>
	</tr>
	<tr>
		<td>Recourse Overhead</td>
		<td>Low</td>
		<td>Variable</td>
	</tr>
</table>

## Migration between patterns
- From Parent-Child to Connected Agents: Extract child agents into independent agents, establish communication protocols, and update the orchestrator agent to manage interactions.
- From Connected Agents to Parent-Child: Consolidate independent agents into a single parent agent, integrate child agent logic, and simplify communication mechanisms.
- Hybrid Approaches: Combine elements of both patterns to leverage the strengths of each, depending on specific use cases and requirements.

### Impact Analysis and Testing
- Thoroughly test the new architecture to ensure seamless functionality and performance.
- Check permissions, authentication, and data flow between agents.
- Plan gradual rollouts to minimize disruptions.

### Rollback Strategies
- Maintain backups of the previous architecture.
- Develop a rollback plan to revert to the previous setup if issues arise during migration.

## Conclusion
Choosing the right architecture pattern for multi-agent orchestration in Copilot Studio is key to achieving the best performance, scalability, and maintainability. By grasping the strengths and weaknesses of both the Parent-Child Agent Architecture and the Connected Agents Architecture, organizations can make smart choices that fit their unique needs and objectives. Careful planning, thorough testing, and effective migration strategies are vital to ensure a seamless transition and successful implementation of the selected architecture.