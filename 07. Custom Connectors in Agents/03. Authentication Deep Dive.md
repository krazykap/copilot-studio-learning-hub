# 03. Authentication Deep Dive:	Securing Custom Connectors
In the world of conversational agents, data is power—but only when it’s accessed securely. Whether you're connecting to public APIs or enterprise-grade systems, authentication is the gatekeeper that ensures your Copilot Studio agents interact safely and responsibly with external services.

In this article, we’ll explore the most common authentication methods supported in Custom Connectors, and walk through a real-world implementation using CurrencyBeacon, a currency conversion API.

## Why Authentication Matters
Authentication isn’t just about access—it’s about trust, compliance, and control. Without proper authentication:
- Sensitive data could be exposed
- APIs may be misused or rate-limited
- Your agent could fail to respond accurately or securely

Copilot Studio supports several authentication schemes to help you build secure, scalable integrations.

## Authentication Types in Custom Connectors
Custom Connectors in Copilot Studio support several authentication methods to accommodate different security requirements. Here are the most common ones:

| Authentication Type | Description | Use Case | Security Level |
|---------------------|-------------|----------|----------------|
| API Key             | A static key passed in the header or query string. | Public APIs, low-risk data. | 🔓 Basic |
| Basic Auth          | Username and password encoded in the request. | Internal APIs, low to medium risk. | 🔐 Moderate |
| OAuth 2.0           | Token-based authentication with user consent and refresh. | Enterprise APIs like Microsoft Graph. | 🔏 High |
| No Auth			  | Open API with no restriction. | Demo or Sandbox APIs. | ❌ None |

## CurrencyBeacon Example: API Key Authentication
Let's revisit our CurrencyBeacon example to see how API Key authentication works in practice.

1. **Obtain an API Key**: Sign up for a CurrencyBeacon account and get your API key from the dashboard.
1. **Create a Custom Connector**: In Copilot Studio, create a new Custom Connector and select "API Key" as the authentication type.
1. **Configure the Connector**:
   - Set the API Key location (header or query).
   - Add the API key value you obtained earlier.
1. **Define the Endpoint**: Set up the endpoint for currency conversion, e.g., `https://api.currencybeacon.com/convert`.
1. **Test the Connector**: Use the built-in testing tools to ensure your connector can successfully authenticate and retrieve data.
1. **Integrate with Your Agent**: Finally, link the Custom Connector to your Copilot Studio agent and test a currency conversion query.

## Best Practices for Secure Authentication
When implementing authentication in your Custom Connectors, consider the following best practices:

✅ **Store keys securely** Use environment variables to store sensitive information like API keys.

🚫 **Avoid hardcoding** keys directly in your code or configuration files.

🔁 **Rotate keys periodically** to reduce the risk of compromise.

📊 **Monitor usage** to detect any unusual activity.


## Whent to use OAuth 2.0
If you are connecting to services that require user-level permissions or need to access sensitive data, OAuth 2.0 is the preferred authentication method. It provides a secure way to delegate access without sharing credentials.
It supports:
- Secure token exchange
- Granular permissions
- Automatic token refresh
- User consent and delegation

### Example: Use Case
Imagine you are building an agent that needs to access a user's Microsoft 365 data. By using OAuth 2.0, the user can securely authorize your agent to access their emails, calendar, and files without sharing their password.
- Microsoft Graph API
- Google APIs
- Salesforce (CRM Data)

### Comparing OAuth 2.0 with API Key
| Feature                    | API Key                      | OAuth 2.0                   |
|-----------------------     |----------------------------- |-----------------------------|
| Setup Complexity           | Low                          | High                        |
| Security                   | Moderate                     | High                         |
| User Specific Access       | ❌ No                        | ✅ Yes                         |
| Token Expriry and Refresh  | ❌ No                        | ✅ Yes                         |
| Enterprise Compliance      | ⚠️ Limited                   | ✅ Full Support |

## Conclusion
Authentication is a critical component of building secure and reliable Custom Connectors in Copilot Studio. By understanding the different authentication methods and implementing best practices, you can ensure that your agents interact safely with external services.
Whether you're using API keys for simple integrations or OAuth 2.0 for complex, user-centric applications, securing your connections is essential for maintaining trust and compliance in today's data-driven world.
For more detailed guidance, refer to the [official documentation on Custom Connectors](https://learn.microsoft.com/en-us/connectors/custom-connectors/define-blank).
